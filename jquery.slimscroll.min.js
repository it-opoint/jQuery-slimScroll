/*! Copyright (c) 2011 Piotr Rochala (http://rocha.la) - Version: 1.1.0.0 */
(function(g,i,k,m,b,d,h,q,t){"use strict";var o=i.document,s=999,c="SS"+i.parseInt(+new Date/k.random()),e={},j="<div/>",a=/^\d+(\.\d+)?px?$/,l={wheelStep:20,width:"auto",height:"250px",size:"7px",restSize:"7px",color:"#000",position:"right",distance:"3px",baseline:"3px",start:"top",opacity:0.4,alwaysVisible:q,disableFadeOut:q,railVisible:h,railOpacity:0.2,enableTouch:h,enableWheel:h,mouseSensitive:h,railColor:"#333",useGlow:q,useRounded:h,glowColor:"#fff",glowSize:"3px",classPrefix:"slimScroll",allowPageScroll:q,scroll:0,touchScrollStep:200,fadeDelay:400,hideDelay:1000},r=function(w,y){var x={};x["-webkit-"+w]=x["-moz-"+w]=x["-ms-"+w]=x["-o-"+w]=x[w]=(""+y);return x},f=function(A,y,x,z){var w=q!==z?r("border-radius",m(x)+"px"):{};w.width=x;A.css(w);y.css(w)},v=function(w,x){if(0<x.length){if(1<x.length){x=g(x[0])}w+=x.position().top;if(0>w){w=0}}return w},n=0,u=function(){var w=this,x=arguments,y=g(j);(function(A,z){if(!z.restSize){z.restSize=""+z.size}z.railClass=z.classPrefix+"Rail",z.railWrapperClass=z.classPrefix+"RailDiv",z.barClass=z.classPrefix+"Bar",z.wrapperClass=z.classPrefix+"Div";g.extend(w,z,{el:A,isOverPanel:q,railW:g(j),isOverRailW:q,rail:g(j),isOverRail:q,bar:g(j),isOverBar:q,minBarHeight:30,isDragging:q,touchDiff:0,barHeight:0,percentScroll:0,lastScroll:0,releaseScroll:q,scrollTo:0,restHideTimer:t,restShowTimer:t,restResetTimer:t})})(x[0],x[1]);w.railW.addClass(w.railWrapperClass).css({display:"block",position:"absolute",width:w.size,top:w.baseline,bottom:w.baseline,background:"transparent none",zIndex:90});w.rail.addClass(w.railClass).css({display:(w.alwaysVisible&&w.railVisible)?"block":"none",position:"absolute",top:0,bottom:0,right:0,width:w.restSize,background:w.railColor,opacity:w.railOpacity,zIndex:95});w.bar.addClass(w.barClass).css({display:w.alwaysVisible?"block":"none",position:"absolute",top:0,right:0,width:w.restSize,background:w.color,opacity:w.opacity,zIndex:99});y.addClass(w.wrapperClass).css({display:"block",position:"relative",overflow:"hidden",width:w.width,height:w.height});w.el.wrap(y);if(0<m(w.size)){f(w.rail,w.bar,w.restSize,w.useRounded)}if(w.useGlow&&0<m(w.glowSize)){w.rail.css(r("box-shadow",w.glowColor+" 0 0 "+w.glowSize))}w.height="auto"===w.height?w.el.parent().innerHeight():w.height;w.el.css({overflow:"hidden",width:w.width,height:w.height});w.railW.css("left"!==w.position.toLowerCase()?"right":"left",w.distance);w.railW.append(w.rail);w.railW.append(w.bar);w.el.after(w.railW);w.attachMouseEvents();if(w.enableTouch){w.el.bind("touchstart",function(z){if(z.originalEvent.touches.length){w.touchDiff=z.originalEvent.touches[0].pageY}});w.el.bind("touchmove",function(z){z.originalEvent.preventDefault();if(z.originalEvent.touches.length){w.scrollContent((w.touchDiff-z.originalEvent.touches[0].pageY)/w.touchScrollStep,h)}})}w.getBarHeight();if("bottom"===w.start){w.bar.css({top:w.getRailWrapperHeight()-w.bar.outerHeight()});w.scrollContent(0,h)}else{if("object"===typeof w.start){w.scrollContent(g(w.start).position().top,t,h);if(!w.alwaysVisible){w.bar.hide()}}}if(!w.alwaysVisible&&!w.railVisible){w.hideRailWrapper()}},p=function(x){var w=this;w.each(function(){var y=this;if(!y[c]||!e[y[c]]){y[c]=++s;e[y[c]]=new u(g(y),g.extend({},l,x))}else{e[y[c]].doAction(x)}});return w};g.fn.extend({slimScroll:p,slimscroll:p});g.extend(u.prototype,{doAction:function(z){var x=this,A=x.el,y,w=A.scrollTop();x.getBarHeight();if("destroy" in z){x.railW.remove();A.unbind();A.unwrap();x.detachMouseWheel()}else{if("html" in z){x.el.html(z.html);x.detachMouseWheel();x.attachMouseEvents(q)}if("scrollTo" in z){y=typeof z.scrollTo;if("number"===y||("string"===y&&a.test(y))){w=m(z.scrollTo)}else{w=v(w,g(z.scrollTo,A))}}else{if("scrollBy" in z){w+=m(z.scrollBy)}}x.scrollContent(w,q,h)}},restResetStyles:function(){var w=this;if(!w.restResetTimer){w.restResetTimer=setInterval(g.proxy(w.restResetStyles,w),100)}else{if(!w.isOverRailW&&!w.isDragging){clearInterval(w.restResetTimer);w.restResetTimer=undefined;f(w.rail,w.bar,w.restSize,w.useRounded)}}},handleEvent:function(y){var w=this,z=0,x;if(!w.isOverPanel){return}x=+new i.Date;if(x<n+10){return}if(!y){y=i.event}if(y.wheelDelta){z=-y.wheelDelta/120}if(y.detail){z=y.detail/3}if(g(y.target||y.srcTarget).closest("."+w.wrapperClass).is(w.el.parent())){w.scrollContent(z,h)}if(y.preventDefault&&!w.releaseScroll){y.preventDefault()}if(!w.releaseScroll){y.returnValue=q}n=x},detachMouseWheel:function(){var w=this,x=w.el[0];if(x.addEventListener){x.removeEventListener("DOMMouseScroll",w,q);x.removeEventListener("mousewheel",w,q)}else{o.detachEvent("onmousewheel",w)}},attachMouseEvents:function(){var x=this,y=x.el,B,z=x.bar,A=x.rail;try{z.draggable("destroy")}catch(w){}z.draggable({axis:"y",containment:"parent",start:function(){x.isDragging=h},stop:function(){x.isDragging=q;x.hideBar()},drag:function(C){x.scrollContent(0,q,q)}});try{A.unbind("mouseenter mouseleave")}catch(w){}A.hover(function(){x.showBar();x.isOverRail=x.railVisible},function(){x.hideBar();x.isOverRail=q});try{z.unbind("mouseenter mouseleave")}catch(w){}z.hover(function(){x.isOverBar=h},function(){x.isOverBar=q});try{y.unbind("mouseenter mouseleave")}catch(w){}y.hover(function(){x.isOverPanel=h;x.showBar();x.hideBar()},function(){x.isOverPanel=q;x.hideBar()});if(x.mouseSensitive){try{y.unbind("mousemove")}catch(w){}y.mousemove(function(){x.isOverPanel=h;x.showBar();x.hideBar()});try{y.unbind("mouseleave")}catch(w){}y.mouseleave(function(){x.isOverPanel=q;x.hideBar()})}if(x.size!=x.restSize){try{x.railW.unbind("mouseenter mouseleave")}catch(w){}x.railW.hover(function(){x.isOverRailW=h;if(!x.restShowTimer){x.restShowTimer=b(function(){x.restShowTimer=undefined;if(x.restHideTimer){d(x.restHideTimer);x.restHideTimer=undefined}f(x.rail,x.bar,x.size,x.useRounded)},200)}},function(){x.isOverRailW=q;if(x.restShowTimer){d(x.restShowTimer);x.restShowTimer=undefined}if(x.restHideTimer){d(x.restHideTimer)}x.restHideTimer=b(function(){x.restHideTimer=undefined;x.restResetStyles()},x.hideDelay/2)})}if(x.enableWheel){B=y[0];if(B.addEventListener){B.addEventListener("DOMMouseScroll",x,q);B.addEventListener("mousewheel",x,q)}else{o.attachEvent("onmousewheel",x)}}},getRailWrapperHeight:function(){var w=this,x=w.el;return k.max(w.railW.outerHeight(),x.outerHeight()-2*m(w.baseline))},scrollContent:function(y,B,C){var F=this,x=F.el,D=F.bar,z=F.getRailWrapperHeight(),A=k.max(0,z-D.outerHeight()),E;if(B){E=m(D.css("top"))+y*m(F.wheelStep)/100*z;E=k.min(k.max(E,0),A);E=(y>0)?k.ceil(E):k.floor(E);D.css({top:E+"px"})}F.percentScroll=m(D.css("top"))/A;E=F.percentScroll*(x[0].scrollHeight-x.outerHeight());if(C){E=y;var w=E/x[0].scrollHeight*z;w=k.min(k.max(w,0),A);D.css({top:w+"px"})}x.scrollTop(E);F.showBarIfNeeded(h);F.hideBar()},getBarHeight:function(){var w=this;w.barHeight=k.max((w.el.outerHeight()/w.el[0].scrollHeight)*w.getRailWrapperHeight(),w.minBarHeight);w.bar.css({height:w.barHeight+"px"})},hideRailWrapper:function(){this.railW.css({visibility:"hidden"})},showRailWrapper:function(){this.railW.css({visibility:"visible"})},clearTimer:function(){var x=this;if(x.queueHide){try{d(x.queueHide)}catch(w){}x.queueHide=undefined}try{delete x.queueHide}catch(w){}},showBarIfNeeded:function(x){var w=this;w.getBarHeight();if(w.barHeight>=w.getRailWrapperHeight()){w.releaseScroll=h;if(h===x){if(w.railVisible){w.rail.hide()}w.bar.hide()}}else{if(w.railVisible){w.rail.stop(h,h).fadeIn(w.fadeDelay)}w.bar.stop(h,h).fadeIn(w.fadeDelay)}w.showRailWrapper()},showBar:function(){var w=this;w.clearTimer();w.showBarIfNeeded();if(!w.releaseScroll&&w.percentScroll===~~w.percentScroll){w.releaseScroll=w.allowPageScroll;if(w.lastScroll!==w.percentScroll){w.el.trigger("slimscroll",0===~~w.percentScroll?"top":"bottom")}}w.lastScroll=w.percentScroll},hideBar:function(){var w=this;if(!w.alwaysVisible){w.clearTimer();w.queueHide=b(function(){w.clearTimer();if(!(w.disableFadeOut&&w.isOverPanel)&&!w.isOverRail&&!w.isOverBar&&!w.isDragging){if(w.railVisible){w.rail.fadeOut(w.fadeDelay)}w.bar.fadeOut(w.fadeDelay,g.proxy(w.hideRailWrapper,w))}},w.hideDelay)}}})})(jQuery,window,Math,parseInt,setTimeout,clearTimeout,!0,!1,null);